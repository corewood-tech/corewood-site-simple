<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Favicons -->
  <link rel="icon" type="image/x-icon" href="{{ '/favicon.ico' | url }}">
  <link rel="icon" type="image/png" sizes="32x32" href="{{ '/favicon.png' | url }}">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ '/favicon.png' | url }}">

  <!-- Font preload -->
  <link rel="preload" href="{{ '/fonts/roca-two-bold.woff2' | url }}" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="{{ '/fonts/hk-grotesk-pro-regular.woff2' | url }}" as="font" type="font/woff2" crossorigin>

  <!-- SEO Meta Tags -->
  <title>{% if title %}{{ title }} | {{ site.title }}{% else %}{{ site.title }} â€” {{ site.description }}{% endif %}</title>
  <meta name="description" content="{{ description or site.description }}">
  <meta name="author" content="{{ site.author }}">
  <meta name="robots" content="{{ robots or 'index, follow' }}">

  <!-- Canonical URL -->
  <link rel="canonical" href="{{ (page.url) | url | absoluteUrl(site.url) }}">

  <!-- Open Graph -->
  <meta property="og:type" content="{{ ogType or 'website' }}">
  <meta property="og:url" content="{{ (page.url) | url | absoluteUrl(site.url) }}">
  <meta property="og:title" content="{% if title %}{{ title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}">
  <meta property="og:description" content="{{ description or site.description }}">
  <meta property="og:image" content="{{ (ogImage or site.seo.defaultImage) | url | absoluteUrl(site.url) }}">

  {% if ogType == 'article' %}
  <meta property="article:author" content="{{ site.author }}">
  <meta property="article:published_time" content="{{ date | date('%Y-%m-%d') }}">
  <meta property="article:section" content="Technology">
  {% if keywords %}
  {% set keywordList = keywords.split(',') %}
  {% for keyword in keywordList %}
  <meta property="article:tag" content="{{ keyword.trim() }}">
  {% endfor %}
  {% endif %}
  {% endif %}

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="{{ (page.url) | url | absoluteUrl(site.url) }}">
  <meta property="twitter:title" content="{% if title %}{{ title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}">
  <meta property="twitter:description" content="{{ description or site.description }}">
  <meta property="twitter:image" content="{{ (ogImage or site.seo.defaultImage) | url | absoluteUrl(site.url) }}">

  {% if keywords %}
  <meta name="keywords" content="{{ keywords }}">
  {% endif %}

  <!-- Styles -->
  <link rel="stylesheet" href="{{ '/assets/css/main.css' | url }}">

  <!-- JSON-LD -->
  {% if jsonLd %}
  <script type="application/ld+json">{{ jsonLd | replace('https://corewood.io', site.url) | safe }}</script>
  {% endif %}

  <!-- PostHog Analytics -->
  <script>
    !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="init capture register register_once register_for_session unregister unregister_for_session getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey getNextSurveyStep identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty createPersonProfile opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing debug".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]);
    var consent = localStorage.getItem('corewood_cookie_consent');
    posthog.init('phc_aeVynFTu2UWNDdZ3SNBx3XUQGBQHAFZrFMyHk6cIHRs', {
      api_host: 'https://helper.corewood.io',
      ui_host: 'https://us.posthog.com',
      person_profiles: 'identified_only',
      cookieless_mode: consent === 'accepted' ? false : 'always'
    });
  </script>
</head>
<body class="min-h-screen text-cream-100 font-body">
  {{ content | safe }}

  <!-- Cookie Consent Banner -->
  <div x-data="{
    show: false,
    init() {
      this.show = !localStorage.getItem('corewood_cookie_consent');
    },
    accept() {
      localStorage.setItem('corewood_cookie_consent', 'accepted');
      if (window.posthog) {
        posthog.capture('cookie_consent', { consent: 'accepted' });
        posthog.set_config({ cookieless_mode: false, persistence: 'localStorage+cookie' });
        posthog.opt_in_capturing();
      }
      this.show = false;
    },
    reject() {
      localStorage.setItem('corewood_cookie_consent', 'rejected');
      if (window.posthog) posthog.capture('cookie_consent', { consent: 'rejected' });
      this.show = false;
    }
  }" x-show="show" x-cloak
     x-transition:enter="transition ease-out duration-300"
     x-transition:enter-start="opacity-0 translate-y-4"
     x-transition:enter-end="opacity-100 translate-y-0"
     x-transition:leave="transition ease-in duration-200"
     x-transition:leave-start="opacity-100 translate-y-0"
     x-transition:leave-end="opacity-0 translate-y-4"
     class="fixed bottom-6 left-4 right-4 md:left-auto md:right-6 md:max-w-md z-[100]"
  >
    <div class="plate-wrap">
      <div class="plate chamfer-full p-6">
        <div class="rivet absolute top-4 left-4 z-10"></div>
        <div class="rivet absolute top-4 right-4 z-10"></div>
        <p class="text-cream-200 text-sm leading-relaxed mb-4">
          We use cookies to understand how you use our site and improve your experience.
          <a href="{{ '/privacy/' | url }}" class="text-morpho-400 hover:text-morpho-300 transition-colors underline">Privacy Policy</a>
        </p>
        <div class="flex gap-3">
          <button @click="accept()" class="btn-primary text-sm px-5 py-2">Accept</button>
          <button @click="reject()" class="btn-secondary text-sm px-5 py-2">Reject</button>
        </div>
      </div>
    </div>
  </div>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="{{ '/assets/js/main.js' | url }}" defer></script>
</body>
</html>
